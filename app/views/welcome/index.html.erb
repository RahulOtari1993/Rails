<% @template = @campaign.campaign_template_detail %>

<!-- Challenges section start -->
<section class="section1 new_section">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="width_100">
          <div class="width_37">
            <%= image_tag("end-user/reward.svg", class: "title_icon") %>
          </div>
          <div class="width_63">
            <h3>Earn Points</h3>
            <p>The <span class="bold_red">more you earn</span> the more you can win!</p>
          </div>
        </div>
      </div>
      <% if !@general_recruit_challenge.blank? %>
        <%= render "challenge", { challenge: @general_recruit_challenge } %>
      <% elsif !@recruit_challenges.empty? %>
        <%= render "challenge", { challenge: @recruit_challenges.first } %>
      <% end %>
      <% unless @challenges.blank? %>
        <% @challenges.each_with_index do |challenge, index| %>
          <%= render "challenge", { challenge: challenge, index: index } %>
        <% end %>
      <% end %>
    </div>
  </div>
</section>
<!-- Challenges section end -->

<!-- Rewards Section start -->
<section class="section2 new_section mb-0">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="width_100">
          <div class="width_37">
            <%= image_tag("end-user/reward.svg", class: "title_icon") %>
          </div>
          <div class="width_63">
            <h3>Current Rewards</h3>
            <p>It's <span class="bold_red">rewarding</span> to stay connected</p>
          </div>
        </div>
      </div>
      <% unless @rewards.blank? %>
        <% @rewards.each_with_index do |reward, index| %>
          <div class="col-12 col-md-4">
            <div class="card image_box">
              <div class="image_inner_text">
                <div class="width_100">
                  <% title = (reward.selection == "redeem") ? "Cash-In" : reward.selection.titleize %>
                  <div class="width_50" style="float: left;"><span class="left"><%= title %> <br> REWARD</span></div>
                  <div class="width_50" style="float: right;"><%= image_tag("end-user/reward.svg", style: "width: 40px;float: right;") %></div>
                </div>
                <div class="clear"></div>
                <%= image_tag(reward.image.url, style: "width:100%;height: auto;margin: 12px 0px;") %>
                <h2 class="image_box_title mt-0 mb-1"><%= reward.name %></h2>
                <h5><%= reward.description %></h5>
                <div class="width_100">
                  <div class="width_50" style="float: left;">
                    <% if current_participant %>
                      <%# unless coupon_claimed(reward) %>
                        <button class="watch_btn reward-claim-modal-btn" data-challenge-id="<%= get_reward_challenge(reward.id) %>" data-reward-id="<%= reward.id %>">Claim</button>
                      <%# end %>
                    <% else %>
                      <button class="watch_btn" data-toggle="modal" data-target="#join_now_modal">Claim</button>
                    <% end %>
                  </div>
                  <div class="width_50" style="float: right;">
                    <span style="float: right;padding-top: 12px;color:#b7b4b4;"><i class="fa fa-clock-o" aria-hidden="true"></i> <%= get_remaining_time_in_words(reward.finish) %></span>
                  </div>
                </div>
                <div class="clear"></div>
              </div>
            </div>
          </div>
        <% end %>
      <% end %>
    </div>
  </div>
</section>
<!-- Rewards Section end -->

<!-- My Rewards Section start -->
<section class="section2 new_section my-rewards" style="background-color: #F5F5F5;">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="width_100" style="margin-top:30px;">
          <div class="width_37">
            <%= image_tag("end-user/reward.svg", class: "title_icon") %>
          </div>
          <div class="width_63">
            <h3>My Rewards</h3>
            <p>All of the <span class="bold_red"> rewards you have earned</span></p>
          </div>
        </div>
      </div>
      <% unless @claimed_rewards.blank? %>
        <% @claimed_rewards.each_with_index do |reward, index| %>
          <div class="col-12 col-md-4">
            <div class="card image_box">
              <div class="image_inner_text">
                <div class="width_100">
                  <% title = (reward.selection == "redeem") ? "Cash-In" : reward.selection.titleize %>
                  <div class="width_50" style="float: left;"><span class="left"><%= title %> <br> REWARD</span></div>
                  <div class="width_50" style="float: right;"><%= image_tag("end-user/reward.svg", style: "width: 40px;float: right;") %></div>
                </div>
                <div class="clear"></div>
                <%= image_tag(reward.image.url, style: "width:100%;height: auto;margin: 12px 0px;") %>
                <h2 class="image_box_title mt-0 mb-1"><%= reward.name %></h2>
                <h5><%= reward.description %></h5>
                <div class="width_100">
                  <div class="width_50" style="float: left;">
                    <% if current_participant %>
                      <button class="watch_btn reward-claim-modal-btn" data-challenge-id="<%= get_reward_challenge(reward.id) %>" data-reward-id="<%= reward.id %>">Learn More</button>
                    <% else %>
                      <button class="watch_btn" data-toggle="modal" data-target="#join_now_modal">Learn More</button>
                    <% end %>
                  </div>
                  <div class="width_50" style="float: right;">
                    <span style="float: right;padding-top: 12px;color:#b7b4b4;"><i class="fa fa-clock-o" aria-hidden="true"></i> <%= get_remaining_time_in_words(reward.finish) %></span>
                  </div>
                </div>
                <div class="clear"></div>
              </div>
            </div>
          </div>
        <% end %>
      <% end %>
    </div>
  </div>
</section>
<!-- My Rewards Section end -->

<% if current_participant.blank? %>
  <!-- Top footer start -->
  <section class="footer_top">
    <div class="container">
      <div class="row">
        <div class="col-md-8 col-lg-9">
          <h4 class="text-white" style="font-weight:900;">The sooner the join, the better your chances!</h4>
          <p style="font-weight: 100;"><strong>FREE to join .</strong> Easy to win.</p>
        </div>
        <div class="col-md-4 col-lg-3">
          <button class="footer_top_btn" data-toggle="modal" data-target="#join_now_modal">JOIN NOW</button>
        </div>
      </div>
    </div>
  </section>
  <!-- Top footer end -->
<% end %>
<div class="clear"></div>

<div class="challenge-submission-modal"></div>
<div class="reward-claim-modal"></div>
<div class="participant-details-modal-div"></div>

<script type="text/javascript">
  $(document).ready(function () {

    // old code
    // var height;
    // $('.image_box_bg .card').each(function() {
    //   height = $(this).innerHeight()
    //   imageDiv = $(this).parent().find('.box_img_style');
    //   imageDiv.css('height', height);
    // });
    // old code

    // ---------------------------------------------------------------------------------
    // I've Shift this code to script.js consider that JS File and Do the Needed Changes
    // Do shift all the JS & CSS code to their relevant CSS & JS Files
    // ---------------------------------------------------------------------------------

    // $('body').on('click', '.challenge-submission-btn', function (e) {
    //   var challengeId = $(this).data('challenge-id');
    // if (<%#= current_participant.present? %>) {
    // $.ajax({
    //   type: 'GET',
    //   url: `/participants/challenges/${challengeId}/details`
    // });
    // } else {
    //   $('#sign_in_modal').modal();
    // }
    // });
  });
</script>

<style media="screen">
  .hero_section {
    padding: 100px 0px 100px;
    background-size: cover;
    background-repeat: no-repeat;
    background-position: center;
  }
</style>
